{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "LambdaManipulation",
            "Effect": "Allow",
            "Action": [
                "lambda:CreateFunction",
                "lambda:UpdateFunctionCode",
                "lambda:UpdateFunctionConfiguration",
                "lambda:GetFunction",
                "lambda:GetFunctionConfiguration",
                "lambda:ListFunctions",
                "lambda:AddPermission",
                "lambda:RemovePermission",
                "lambda:GetPolicy"
            ],
            "Resource": "*"{{IP_CONDITION}}
    },
        {
            "Sid": "IAMRoleManipulation",
            "Effect": "Allow",
            "Action": [
                "iam:GetRole",
                "iam:CreateRole",
                "iam:AttachRolePolicy",
                "iam:PutRolePolicy",
                "iam:ListRoles",
                "iam:ListRolePolicies",
                "iam:GetRolePolicy",
                "iam:ListAttachedRolePolicies"
            ],
            "Resource": "*"{{IP_CONDITION}}
    },
        {
            "Sid": "IAMPassRoleForLambda",
            "Effect": "Allow",
            "Action": "iam:PassRole",
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "iam:PassedToService": "lambda.amazonaws.com"
                }{{IP_CONDITION_COMMA}}
    }
    },
        {
            "Sid": "KMSManipulation",
            "Effect": "Allow",
            "Action": [
                "kms:CreateKey",
                "kms:DescribeKey",
                "kms:ListKeys",
                "kms:ListAliases",
                "kms:PutKeyPolicy",
                "kms:GetKeyPolicy"
            ],
            "Resource": "*"{{IP_CONDITION}}
    },
        {
            "Sid": "CognitoManipulation",
            "Effect": "Allow",
            "Action": [
                "cognito-idp:CreateUserPool",
                "cognito-idp:DescribeUserPool",
                "cognito-idp:ListUserPools",
                "cognito-idp:UpdateUserPool",
                "cognito-idp:ListUserPoolClients"
            ],
            "Resource": "*"{{IP_CONDITION}}
    },
        {
            "Sid": "CognitoAdminActionsForTesting",
            "Effect": "Allow",
            "Action": [
                "cognito-idp:AdminCreateUser",
                "cognito-idp:AdminResetUserPassword",
                "cognito-idp:AdminDeleteUser",
                "cognito-idp:AdminSetUserPassword"
            ],
            "Resource": "arn:aws:cognito-idp:*:{{AWS_ACCOUNT}}:userpool/*"{{IP_CONDITION}}
    }
    ]
}